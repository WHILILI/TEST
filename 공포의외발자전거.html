<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>공포의 외발자전거</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(180deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            color: white;
            overflow: hidden;
            height: 100vh;
        }

        .game-container {
            width: 100vw;
            height: 100vh;
            position: relative;
            overflow: hidden;
        }

        .hud {
            position: absolute;
            top: 20px;
            left: 20px;
            right: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 100;
            background: rgba(0, 0, 0, 0.5);
            padding: 15px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
        }

        .title {
            font-size: 2em;
            font-weight: bold;
            color: #FF6B6B;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
        }

        .stats {
            display: flex;
            gap: 30px;
            font-size: 1.2em;
        }

        .stat-item {
            text-align: center;
        }

        .stat-value {
            font-size: 1.5em;
            font-weight: bold;
            color: #FFD700;
        }

        .game-world {
            position: absolute;
            width: 200%;
            height: 100vh;
            background: linear-gradient(180deg, #1a1a2e 0%, #2d1b69 100%);
            transition: transform 0.1s ease-out;
        }

        .ground {
            position: absolute;
            bottom: 0;
            width: 100%;
            height: 200px;
            background: linear-gradient(180deg, #333 0%, #111 100%);
            border-top: 3px solid #555;
        }

        .ground-pattern {
            position: absolute;
            bottom: 0;
            width: 100%;
            height: 50px;
            background: repeating-linear-gradient(
                90deg,
                #444 0px,
                #444 50px,
                #333 50px,
                #333 100px
            );
        }

        .obstacles {
            position: absolute;
            bottom: 200px;
            width: 100%;
            height: 300px;
        }

        .obstacle {
            position: absolute;
            background: #8B0000;
            border: 2px solid #FF0000;
            border-radius: 5px;
        }

        .unicycle-container {
            position: absolute;
            left: 200px;
            bottom: 200px;
            width: 80px;
            height: 120px;
            transition: transform 0.1s ease-out;
            transform-origin: bottom center;
        }

        .wheel {
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 60px;
            height: 60px;
            border: 6px solid #333;
            border-radius: 50%;
            background: radial-gradient(circle, #666 0%, #333 100%);
            animation: wheelSpin 0.5s linear infinite;
        }

        @keyframes wheelSpin {
            0% { transform: translateX(-50%) rotate(0deg); }
            100% { transform: translateX(-50%) rotate(360deg); }
        }

        .rider {
            position: absolute;
            bottom: 50px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 2.5em;
            transition: transform 0.1s ease-out;
        }

        .balance-meter {
            position: absolute;
            top: 150px;
            left: 50%;
            transform: translateX(-50%);
            width: 300px;
            height: 20px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            border: 2px solid white;
            z-index: 50;
        }

        .balance-indicator {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            width: 20px;
            height: 30px;
            background: #FF6B6B;
            border-radius: 5px;
            transition: left 0.1s ease-out;
            box-shadow: 0 0 10px rgba(255, 107, 107, 0.5);
        }

        .balance-zones {
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 10px;
            background: linear-gradient(90deg, 
                #FF0000 0%, #FF4500 15%, #FFD700 25%, 
                #00FF00 40%, #00FF00 60%, 
                #FFD700 75%, #FF4500 85%, #FF0000 100%);
            opacity: 0.7;
        }

        .controls {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.7);
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            z-index: 100;
        }

        .control-hint {
            font-size: 1.2em;
            margin-bottom: 10px;
        }

        .key-display {
            display: flex;
            gap: 20px;
            justify-content: center;
        }

        .key {
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 8px;
            padding: 10px 15px;
            font-size: 1.1em;
            transition: all 0.2s ease;
        }

        .key.pressed {
            background: rgba(255, 107, 107, 0.5);
            border-color: #FF6B6B;
            transform: scale(1.1);
        }

        .danger-warning {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 3em;
            color: #FF0000;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
            animation: dangerPulse 0.5s ease-in-out infinite alternate;
            z-index: 200;
            display: none;
        }

        @keyframes dangerPulse {
            0% { transform: translate(-50%, -50%) scale(1); }
            100% { transform: translate(-50%, -50%) scale(1.2); }
        }

        .game-over {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.9);
            padding: 40px;
            border-radius: 20px;
            border: 3px solid #FF6B6B;
            text-align: center;
            z-index: 300;
            display: none;
        }

        .game-over h2 {
            color: #FF6B6B;
            font-size: 2.5em;
            margin-bottom: 20px;
        }

        .restart-btn {
            padding: 15px 30px;
            font-size: 1.2em;
            border: none;
            border-radius: 10px;
            background: linear-gradient(45deg, #FF6B6B, #FF5252);
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 20px;
        }

        .restart-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(255, 107, 107, 0.3);
        }

        .speed-indicator {
            position: absolute;
            top: 220px;
            right: 20px;
            background: rgba(0, 0, 0, 0.7);
            padding: 15px;
            border-radius: 10px;
            z-index: 50;
        }

        .speed-meter {
            width: 150px;
            height: 20px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            overflow: hidden;
            margin-top: 10px;
        }

        .speed-fill {
            height: 100%;
            background: linear-gradient(90deg, #00FF00 0%, #FFD700 50%, #FF0000 100%);
            width: 0%;
            transition: width 0.2s ease;
        }

        .stars {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 50%;
            overflow: hidden;
        }

        .star {
            position: absolute;
            color: white;
            font-size: 0.8em;
            opacity: 0.7;
            animation: starTwinkle 2s ease-in-out infinite alternate;
        }

        @keyframes starTwinkle {
            0% { opacity: 0.3; }
            100% { opacity: 1; }
        }

        .achievement {
            position: absolute;
            top: 30%;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(255, 215, 0, 0.9);
            color: black;
            padding: 15px 30px;
            border-radius: 15px;
            font-size: 1.5em;
            font-weight: bold;
            animation: achievementSlide 3s ease-out forwards;
            z-index: 150;
            display: none;
        }

        @keyframes achievementSlide {
            0% { 
                transform: translateX(-50%) translateY(-100px);
                opacity: 0;
            }
            20% { 
                transform: translateX(-50%) translateY(0);
                opacity: 1;
            }
            80% { 
                transform: translateX(-50%) translateY(0);
                opacity: 1;
            }
            100% { 
                transform: translateX(-50%) translateY(-100px);
                opacity: 0;
            }
        }

        .mobile-controls {
            position: absolute;
            bottom: 120px;
            left: 50%;
            transform: translateX(-50%);
            display: none;
            gap: 30px;
        }

        .mobile-btn {
            width: 80px;
            height: 80px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 2em;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .mobile-btn:active {
            background: rgba(255, 107, 107, 0.5);
            transform: scale(1.1);
        }

        @media (max-width: 768px) {
            .mobile-controls {
                display: flex;
            }
            
            .controls {
                bottom: 220px;
            }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <div class="hud">
            <div class="title">💀 공포의 외발자전거 💀</div>
            <div class="stats">
                <div class="stat-item">
                    <div>거리</div>
                    <div class="stat-value"><span id="distance">0</span>m</div>
                </div>
                <div class="stat-item">
                    <div>최고기록</div>
                    <div class="stat-value"><span id="best-distance">0</span>m</div>
                </div>
                <div class="stat-item">
                    <div>시간</div>
                    <div class="stat-value"><span id="time">0</span>초</div>
                </div>
            </div>
        </div>

        <div class="stars" id="stars"></div>

        <div class="balance-meter">
            <div class="balance-zones"></div>
            <div class="balance-indicator" id="balance-indicator"></div>
        </div>

        <div class="speed-indicator">
            <div>속도</div>
            <div class="speed-meter">
                <div class="speed-fill" id="speed-fill"></div>
            </div>
            <div style="margin-top: 5px;"><span id="speed-value">0</span> km/h</div>
        </div>

        <div class="game-world" id="game-world">
            <div class="ground">
                <div class="ground-pattern"></div>
            </div>
            
            <div class="obstacles" id="obstacles"></div>
            
            <div class="unicycle-container" id="unicycle">
                <div class="rider" id="rider">🤡</div>
                <div class="wheel"></div>
            </div>
        </div>

        <div class="controls">
            <div class="control-hint">균형을 잡으세요!</div>
            <div class="key-display">
                <div class="key" id="left-key">← A</div>
                <div class="key" id="right-key">→ D</div>
            </div>
        </div>

        <div class="mobile-controls">
            <div class="mobile-btn" id="mobile-left">←</div>
            <div class="mobile-btn" id="mobile-right">→</div>
        </div>

        <div class="danger-warning" id="danger-warning">⚠️ 위험! ⚠️</div>

        <div class="achievement" id="achievement">🏆 업적 달성!</div>

        <div class="game-over" id="game-over">
            <h2>💥 추락!</h2>
            <p>균형을 잃고 떨어졌습니다!</p>
            <p>이동 거리: <span id="final-distance">0</span>m</p>
            <p>생존 시간: <span id="final-time">0</span>초</p>
            <button class="restart-btn" onclick="restartGame()">다시 도전</button>
        </div>
    </div>

    <script>
        let gameState = {
            isPlaying: true,
            balance: 50,
            speed: 0,
            distance: 0,
            time: 0,
            bestDistance: parseInt(localStorage.getItem('bestDistance')) || 0,
            worldOffset: 0,
            tilt: 0,
            achievements: new Set()
        };

        let keys = {
            left: false,
            right: false
        };

        let gameTimer;
        let lastTime = 0;

        function initGame() {
            generateStars();
            generateObstacles();
            updateHUD();
            startGameLoop();
        }

        function generateStars() {
            const starsContainer = document.getElementById('stars');
            for (let i = 0; i < 50; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                star.textContent = '⭐';
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 100 + '%';
                star.style.animationDelay = Math.random() * 2 + 's';
                starsContainer.appendChild(star);
            }
        }

        function generateObstacles() {
            const obstaclesContainer = document.getElementById('obstacles');
            const gameWorld = document.getElementById('game-world');
            const worldWidth = gameWorld.offsetWidth;
            
            for (let i = 0; i < 20; i++) {
                const obstacle = document.createElement('div');
                obstacle.className = 'obstacle';
                obstacle.style.left = (500 + i * 200 + Math.random() * 100) + 'px';
                obstacle.style.bottom = Math.random() * 100 + 'px';
                obstacle.style.width = (20 + Math.random() * 30) + 'px';
                obstacle.style.height = (30 + Math.random() * 50) + 'px';
                obstaclesContainer.appendChild(obstacle);
            }
        }

        function startGameLoop() {
            gameTimer = setInterval(() => {
                if (gameState.isPlaying) {
                    updatePhysics();
                    updateBalance();
                    updateSpeed();
                    updateWorld();
                    updateHUD();
                    checkCollisions();
                    checkAchievements();
                    
                    gameState.time += 0.1;
                }
            }, 100);
        }

        function updatePhysics() {
            if (keys.left && !keys.right) {
                gameState.balance -= 2;
                gameState.tilt = Math.max(gameState.tilt - 0.5, -15);
            } else if (keys.right && !keys.left) {
                gameState.balance += 2;
                gameState.tilt = Math.min(gameState.tilt + 0.5, 15);
            } else {
                if (gameState.balance < 50) {
                    gameState.balance += 0.5;
                } else if (gameState.balance > 50) {
                    gameState.balance -= 0.5;
                }
                gameState.tilt *= 0.9;
            }

            gameState.balance = Math.max(0, Math.min(100, gameState.balance));
            
            const balanceDeviation = Math.abs(gameState.balance - 50);
            if (balanceDeviation < 10) {
                gameState.speed += 0.1;
            } else if (balanceDeviation < 20) {
                gameState.speed += 0.05;
            } else {
                gameState.speed -= 0.1;
            }
            
            gameState.speed = Math.max(0, Math.min(50, gameState.speed));
            gameState.distance += gameState.speed * 0.1;
            gameState.worldOffset += gameState.speed * 0.5;
        }

        function updateBalance() {
            const indicator = document.getElementById('balance-indicator');
            const position = (gameState.balance / 100) * 280;
            indicator.style.left = position + 'px';
            
            const balanceDeviation = Math.abs(gameState.balance - 50);
            if (balanceDeviation > 40) {
                document.getElementById('danger-warning').style.display = 'block';
                if (balanceDeviation > 45) {
                    gameOver();
                }
            } else {
                document.getElementById('danger-warning').style.display = 'none';
            }
        }

        function updateSpeed() {
            const speedFill = document.getElementById('speed-fill');
            const speedValue = document.getElementById('speed-value');
            
            const speedPercentage = (gameState.speed / 50) * 100;
            speedFill.style.width = speedPercentage + '%';
            speedValue.textContent = Math.round(gameState.speed * 2);
        }

        function updateWorld() {
            const gameWorld = document.getElementById('game-world');
            gameWorld.style.transform = `translateX(-${gameState.worldOffset}px)`;
            
            const unicycle = document.getElementById('unicycle');
            unicycle.style.transform = `rotate(${gameState.tilt}deg)`;
            
            const rider = document.getElementById('rider');
            const riderTilt = -gameState.tilt * 0.5;
            rider.style.transform = `translateX(-50%) rotate(${riderTilt}deg)`;
        }

        function updateHUD() {
            document.getElementById('distance').textContent = Math.floor(gameState.distance);
            document.getElementById('best-distance').textContent = gameState.bestDistance;
            document.getElementById('time').textContent = Math.floor(gameState.time);
        }

        function checkCollisions() {
            const obstacles = document.querySelectorAll('.obstacle');
            const unicycleRect = document.getElementById('unicycle').getBoundingClientRect();
            
            obstacles.forEach(obstacle => {
                const obstacleRect = obstacle.getBoundingClientRect();
                if (unicycleRect.left < obstacleRect.right &&
                    unicycleRect.right > obstacleRect.left &&
                    unicycleRect.top < obstacleRect.bottom &&
                    unicycleRect.bottom > obstacleRect.top) {
                    gameOver();
                }
            });
        }

        function checkAchievements() {
            const distance = Math.floor(gameState.distance);
            
            if (distance >= 100 && !gameState.achievements.has('first_100')) {
                gameState.achievements.add('first_100');
                showAchievement('🎯 첫 100m 달성!');
            }
            
            if (distance >= 500 && !gameState.achievements.has('half_km')) {
                gameState.achievements.add('half_km');
                showAchievement('🏃 500m 돌파!');
            }
            
            if (distance >= 1000 && !gameState.achievements.has('one_km')) {
                gameState.achievements.add('one_km');
                showAchievement('🚀 1km 달성!');
            }
            
            if (gameState.time >= 60 && !gameState.achievements.has('one_minute')) {
                gameState.achievements.add('one_minute');
                showAchievement('⏰ 1분 생존!');
            }
        }

        function showAchievement(text) {
            const achievement = document.getElementById('achievement');
            achievement.textContent = text;
            achievement.style.display = 'block';
            achievement.style.animation = 'none';
            achievement.offsetHeight;
            achievement.style.animation = 'achievementSlide 3s ease-out forwards';
            
            setTimeout(() => {
                achievement.style.display = 'none';
            }, 3000);
        }

        function gameOver() {
            if (!gameState.isPlaying) return;
            
            gameState.isPlaying = false;
            clearInterval(gameTimer);
            
            const finalDistance = Math.floor(gameState.distance);
            if (finalDistance > gameState.bestDistance) {
                gameState.bestDistance = finalDistance;
                localStorage.setItem('bestDistance', gameState.bestDistance);
            }
            
            document.getElementById('final-distance').textContent = finalDistance;
            document.getElementById('final-time').textContent = Math.floor(gameState.time);
            document.getElementById('game-over').style.display = 'block';
        }

        function restartGame() {
            gameState = {
                isPlaying: true,
                balance: 50,
                speed: 0,
                distance: 0,
                time: 0,
                bestDistance: gameState.bestDistance,
                worldOffset: 0,
                tilt: 0,
                achievements: gameState.achievements
            };
            
            keys = { left: false, right: false };
            
            document.getElementById('game-over').style.display = 'none';
            document.getElementById('danger-warning').style.display = 'none';
            document.getElementById('game-world').style.transform = 'translateX(0)';
            document.getElementById('unicycle').style.transform = 'rotate(0deg)';
            
            updateHUD();
            startGameLoop();
        }

        function handleKeyDown(event) {
            switch (event.key.toLowerCase()) {
                case 'a':
                case 'arrowleft':
                    keys.left = true;
                    document.getElementById('left-key').classList.add('pressed');
                    event.preventDefault();
                    break;
                case 'd':
                case 'arrowright':
                    keys.right = true;
                    document.getElementById('right-key').classList.add('pressed');
                    event.preventDefault();
                    break;
                case 'r':
                    if (!gameState.isPlaying) {
                        restartGame();
                    }
                    break;
            }
        }

        function handleKeyUp(event) {
            switch (event.key.toLowerCase()) {
                case 'a':
                case 'arrowleft':
                    keys.left = false;
                    document.getElementById('left-key').classList.remove('pressed');
                    event.preventDefault();
                    break;
                case 'd':
                case 'arrowright':
                    keys.right = false;
                    document.getElementById('right-key').classList.remove('pressed');
                    event.preventDefault();
                    break;
            }
        }

        document.getElementById('mobile-left').addEventListener('mousedown', () => {
            keys.left = true;
            document.getElementById('left-key').classList.add('pressed');
        });

        document.getElementById('mobile-left').addEventListener('mouseup', () => {
            keys.left = false;
            document.getElementById('left-key').classList.remove('pressed');
        });

        document.getElementById('mobile-right').addEventListener('mousedown', () => {
            keys.right = true;
            document.getElementById('right-key').classList.add('pressed');
        });

        document.getElementById('mobile-right').addEventListener('mouseup', () => {
            keys.right = false;
            document.getElementById('right-key').classList.remove('pressed');
        });

        document.getElementById('mobile-left').addEventListener('touchstart', (e) => {
            e.preventDefault();
            keys.left = true;
            document.getElementById('left-key').classList.add('pressed');
        });

        document.getElementById('mobile-left').addEventListener('touchend', (e) => {
            e.preventDefault();
            keys.left = false;
            document.getElementById('left-key').classList.remove('pressed');
        });

        document.getElementById('mobile-right').addEventListener('touchstart', (e) => {
            e.preventDefault();
            keys.right = true;
            document.getElementById('right-key').classList.add('pressed');
        });

        document.getElementById('mobile-right').addEventListener('touchend', (e) => {
            e.preventDefault();
            keys.right = false;
            document.getElementById('right-key').classList.remove('pressed');
        });

        document.addEventListener('keydown', handleKeyDown);
        document.addEventListener('keyup', handleKeyUp);

        window.addEventListener('beforeunload', () => {
            localStorage.setItem('bestDistance', gameState.bestDistance);
        });

        initGame();
    </script>
</body>
</html>